# 产品设计文档 (PRD)
**项目代号：** DianDian
**版本：** v0.1 (MVP)
**核心形态：** 本地安装的桌面应用 (Windows/Mac)
**底层架构：** Electron (前端交互) + Python (AI推理与浏览器控制)

---

## 1. 产品愿景与定位
*   **Slogan:** "像聊天一样完成软件测试。" (Chat to Test)
*   **核心价值:** 为不懂代码的手工测试人员（Manual QA）提供一个“AI 结对测试搭档”。用户用自然语言下达指令，AI 在本地浏览器自动执行，并生成可视化报告。
*   **解决了什么问题:**
    *   **去代码化:** 无需学习 Python、Selenium 或 Playwright。
    *   **解决环境痛点:** 无需配置复杂的开发环境，下载即用，支持内网/Localhost 测试。
    *   **降低维护成本:** 利用 AI 的自愈能力，应对 UI 细微变化，不再因为一个 class 名改变而重写脚本。

## 2. 目标用户画像 (Persona)
*   **核心用户：小张 (QA 专员)**
    *   工作内容：负责公司 ERP 系统的功能测试，通过点点点来验证 Bug。
    *   痛点：每次发版都要重复点击几百次相同的流程，枯燥且容易漏测；想学自动化但代码太难。
    *   期望：告诉软件“帮我测一下登录流程”，软件自动跑完并告诉我结果。

## 3. 核心业务流程 (User Journey)

1.  **安装:** 用户下载安装包，一键安装（应用内部自动解压微型 Python 环境）。
2.  **新建任务:** 用户输入测试目标（例如：“测试访客购买红色T恤流程”）。
3.  **交互式执行 (Human-in-the-loop):**
    *   应用弹出一个嵌入式的浏览器窗口。
    *   AI 分析页面，高亮显示操作元素。
    *   AI 执行点击/输入，同时在侧边栏实时输出日志（“正在点击登录按钮...”）。
    *   *关键点:* 如果 AI 卡住了，用户可以点击“接管控制”，手动点一下，然后让 AI 继续。
4.  **生成报告:** 测试结束，生成一份包含视频回放、关键步骤截图的 HTML 报告。
5.  **保存用例:** 用户将这次成功的对话保存为“自动化用例”，下次一键回放。

---

## 4. 功能模块详述

### 4.1 首页/工作台 (Dashboard)
*   **新建测试:** 大大的输入框，类似于 ChatGPT，输入 URL 和测试目的。
*   **历史记录:** 显示最近执行的测试任务及结果（通过/失败）。
*   **用例库:** 管理已保存的“黄金流程”（Golden Path），支持分组（如：登录模块、支付模块）。
*   **环境设置:** 设置基础 URL（Dev/Staging/Prod 切换）。

### 4.2 核心测试窗口 (The Runner)
这是产品最核心的界面，采用**左右分屏**设计：

*   **左侧：对话与指令区 (Chat Interface)**
    *   **输入框:** 输入自然语言指令（如“校验密码错误时的提示文案”）。
    *   **执行流 (Trace):** 气泡式展示 AI 的思维过程（Thought）和操作（Action）。
        *   *例子:* 🤖 思维: "检测到登录框，准备输入用户名。" -> ⚡ 动作: "输入 'admin'"
    *   **干预按钮:**
        *   ⏸️ **暂停 (Pause):** 暂停 AI 操作。
        *   ✋ **接管 (Take Control):** 用户手动操作浏览器，操作完成后交还给 AI。
        *   ✅ **确认 (Validate):** 某些关键步骤需要用户人工确认（如验证码）。

*   **右侧：实时浏览器视图 (Live Browser)**
    *   这是一个嵌入的 Chromium 视图 (基于 Playwright)。
    *   **视觉增强 (SoM Layer):** 在 AI 识别模式下，页面元素上会悬浮半透明的红色数字标签（Set-of-Mark），让用户知道 AI “看”到了什么。
    *   **高亮操作:** AI 正在操作的元素会有高亮边框。

### 4.3 报告与回溯 (Reporting)
*   **本地报告:** 每次执行自动生成 HTML 文件（存储在用户“文档”目录）。
*   **内容包含:**
    *   执行摘要（成功/失败，耗时）。
    *   **全过程视频录制** (MP4)。
    *   **步骤详情:** 每一步的截图、AI 的推理逻辑、操作日志。
    *   **网络日志:** 抓取 API 报错（404/500），方便甩锅给开发。

### 4.4 设置 (Settings)
*   **模型配置 (核心):**
    *   **模式 A (默认):** 输入用户的 OpenAI/Anthropic API Key。
    *   **模式 B (私有化):** 连接本地 Ollama (Llama 3 / Qwen) 地址，针对极度敏感的内网环境。
*   **浏览器配置:** 模拟设备（桌面/iPhone 12/iPad）、无头模式开关。
*   **代理设置:** 兼容公司内网的 Proxy。

---

## 5. 关键交互细节 (UX Requirements)

1.  **初始化体验:**
    *   应用首次启动时，需检查并初始化 Python 环境（这一步必须有进度条，不能让用户觉得死机了）。
    *   **文案:** "正在初始化 AI 引擎..." (实际是在解压 embedded python 和 pip install)。

2.  **错误处理 (自愈演示):**
    *   当 AI 找不到元素时，不应直接报错 Crash。
    *   **交互:** 界面变黄，提示用户“我没找到‘提交’按钮，请手动帮我点一下，或者在对话框里告诉我它在哪”。
    *   用户帮助后，AI 记录该特征，下次自动修正。

3.  **隐私提示:**
    *   明确告知用户：截图会发送给大模型厂商（OpenAI），但在本地模型模式下数据不出域。

---

## 6. 核心技术指标 (Non-functional Requirements)
*   **安装包大小:** 控制在 300MB 以内（Electron + Python Runtime 很大，需要裁剪）。
*   **启动速度:** 冷启动 < 5秒。
*   **稳定性:** 连续运行 1 小时内存不泄露。
*   **兼容性:** Windows 10/11, macOS (Intel/M系列)。

---

## 7. 商业化预留 (Roadmap)
*   **MVP (当前):** 纯本地工具，用户自带 API Key。
*   **V1.5 (Pro版):** 提供内置的高速云端 LLM 通道（SaaS订阅制，用户免配 Key），支持云端同步用例库。
*   **V2.0 (Team版):** 团队协作，本地跑完数据上传 Dashboard，生成团队质量报表。
